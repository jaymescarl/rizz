-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false

-- Create Frame
local frame = Instance.new("Frame")
frame.Parent = screenGui
frame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
frame.Size = UDim2.new(0, 300, 0, 420)
frame.Position = UDim2.new(0.5, -150, 0.5, -210)
frame.Active = true
frame.Draggable = false

-- Status Label
local statusLabel = Instance.new("TextLabel")
statusLabel.Parent = frame
statusLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.Size = UDim2.new(0, 300, 0, 30)
statusLabel.Position = UDim2.new(0, 0, 0, -40)
statusLabel.Text = "Status: Normal Speed (1)"
statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
statusLabel.TextScaled = true

-- Create Speed Input Field Function
local function createInputField(parent, posX, posY, defaultText)
    local input = Instance.new("TextBox")
    input.Parent = parent
    input.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    input.Size = UDim2.new(0, 120, 0, 30)
    input.Position = UDim2.new(0, posX, 0, posY)
    input.Text = defaultText
    input.TextScaled = true
    input.PlaceholderText = "Enter Speed"
    return input
end

-- Create Normal Speed Button
local normalButton = Instance.new("TextButton")
normalButton.Parent = frame
normalButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
normalButton.Size = UDim2.new(0.4, 0, 0, 30)
normalButton.Position = UDim2.new(0.1, 0, 0.1, 0)
normalButton.Text = "Normal Speed (1)"
normalButton.TextScaled = true

-- Create SlowMo Speed Button and Input
local slowMoButton = Instance.new("TextButton")
slowMoButton.Parent = frame
slowMoButton.BackgroundColor3 = Color3.fromRGB(100, 149, 237)
slowMoButton.Size = UDim2.new(0.4, 0, 0, 30)
slowMoButton.Position = UDim2.new(0.1, 0, 0.2, 0)
slowMoButton.Text = "SlowMo Speed (0.2)"
slowMoButton.TextScaled = true

local slowMoInput = createInputField(frame, 160, 60, "0.2")

-- Create Faster Speed Button and Input
local fasterButton = Instance.new("TextButton")
fasterButton.Parent = frame
fasterButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
fasterButton.Size = UDim2.new(0.4, 0, 0, 30)
fasterButton.Position = UDim2.new(0.1, 0, 0.3, 0)
fasterButton.Text = "Faster Speed (2)"
fasterButton.TextScaled = true

local fasterInput = createInputField(frame, 160, 100, "2")

-- Create Reverse Speed Button and Input
local reverseButton = Instance.new("TextButton")
reverseButton.Parent = frame
reverseButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
reverseButton.Size = UDim2.new(0.4, 0, 0, 30)
reverseButton.Position = UDim2.new(0.1, 0, 0.4, 0)
reverseButton.Text = "Reverse Speed (-0.8)"

local reverseInput = createInputField(frame, 160, 140, "-0.8")

-- Create Custom Speed Button and Input
local customButton = Instance.new("TextButton")
customButton.Parent = frame
customButton.BackgroundColor3 = Color3.fromRGB(255, 255, 0)
customButton.Size = UDim2.new(0.4, 0, 0, 30)
customButton.Position = UDim2.new(0.1, 0, 0.5, 0)
customButton.Text = "Custom Speed (0)"

local customInput = createInputField(frame, 160, 180, "0")

-- Create Resize Handle
local resizeHandle = Instance.new("Frame")
resizeHandle.Parent = frame
resizeHandle.Size = UDim2.new(0, 20, 0, 20)
resizeHandle.Position = UDim2.new(1, -20, 1, -20)
resizeHandle.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
resizeHandle.Active = true
resizeHandle.Draggable = true

local dragging = false
local dragInput, startPos, startSize

-- Frame Dragging
local function startDragging(input)
    dragging = true
    dragInput = input
    startPos = input.Position
    startSize = frame.Size
end

local function stopDragging()
    dragging = false
end

resizeHandle.MouseButton1Down:Connect(startDragging)
resizeHandle.MouseButton1Up:Connect(stopDragging)

-- InputChanged to resize
game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - startPos
        frame.Size = UDim2.new(startSize.X.Scale, startSize.X.Offset + delta.X, startSize.Y.Scale, startSize.Y.Offset + delta.Y)
    end
end)

-- Mobile Dragging Support
local touchStartPos
local touchDragging = false

resizeHandle.TouchBegin:Connect(function(touch)
    touchDragging = true
    touchStartPos = touch.Position
end)

game:GetService("UserInputService").TouchMoved:Connect(function(touch)
    if touchDragging then
        local delta = touch.Position - touchStartPos
        frame.Size = UDim2.new(startSize.X.Scale, startSize.X.Offset + delta.X, startSize.Y.Scale, startSize.Y.Offset + delta.Y)
    end
end)

resizeHandle.TouchEnd:Connect(function()
    touchDragging = false
end)

-- Animation Speed Variables
local speedMultiplier = 1

-- Function to modify animation speed
local function modifyAnimationSpeed()
    local character = game.Players.LocalPlayer.Character
    if character then
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            for _, animTrack in pairs(humanoid:GetPlayingAnimationTracks()) do
                animTrack:AdjustSpeed(speedMultiplier)
            end
        end
    end
end

-- Function to update status
local function updateStatus(text, color)
    statusLabel.Text = text
    statusLabel.TextColor3 = color
    modifyAnimationSpeed()
end

-- Button Functions
normalButton.MouseButton1Click:Connect(function()
    speedMultiplier = 1
    updateStatus("Status: Normal Speed (1)", Color3.fromRGB(0, 255, 0))
end)

slowMoButton.MouseButton1Click:Connect(function()
    local enteredSpeed = tonumber(slowMoInput.Text) or 0.2
    speedMultiplier = enteredSpeed
    updateStatus("Status: SlowMo Speed ("..enteredSpeed..")", Color3.fromRGB(100, 149, 237))
end)

fasterButton.MouseButton1Click:Connect(function()
    local enteredSpeed = tonumber(fasterInput.Text) or 2
    if enteredSpeed > 0 then
        speedMultiplier = enteredSpeed
        updateStatus("Status: Faster Speed ("..enteredSpeed..")", Color3.fromRGB(0, 0, 255))
    end
end)

reverseButton.MouseButton1Click:Connect(function()
    local enteredSpeed = tonumber(reverseInput.Text) or -0.8
    if enteredSpeed > 0 then enteredSpeed = -enteredSpeed end -- Ensure reverse is negative
    speedMultiplier = enteredSpeed
    updateStatus("Status: Reverse Speed ("..enteredSpeed..")", Color3.fromRGB(255, 0, 0))
end)

customButton.MouseButton1Click:Connect(function()
    local enteredSpeed = tonumber(customInput.Text) or 0
    speedMultiplier = enteredSpeed
    updateStatus("Status: Custom Speed ("..enteredSpeed..")", Color3.fromRGB(255, 255, 0))
end)

-- Constantly monitor animation and adjust speed to prevent reset
game:GetService("RunService").RenderStepped:Connect(modifyAnimationSpeed)
